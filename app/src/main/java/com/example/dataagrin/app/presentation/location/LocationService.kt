package com.example.dataagrin.app.presentation.location\n\nimport android.annotation.SuppressLint\nimport android.content.Context\nimport android.location.Location\nimport com.google.android.gms.location.LocationServices\nimport kotlinx.coroutines.suspendCancellableCoroutine\nimport kotlin.coroutines.resume\n\ninterface LocationService {\n    suspend fun getCurrentLocation(): Location?\n}\n\nclass LocationServiceImpl(private val context: Context) : LocationService {\n\n    private val fusedLocationClient = LocationServices.getFusedLocationProviderClient(context)\n\n    @SuppressLint(\"MissingPermission\")\n    override suspend fun getCurrentLocation(): Location? {\n        return suspendCancellableCoroutine {\ continuation ->\n            fusedLocationClient.lastLocation.addOnSuccessListener {\n                continuation.resume(it)\n            }.addOnFailureListener {\n                continuation.resume(null)\n            }.addOnCanceledListener {\n                continuation.cancel()\n            }\n        }\n    }\n}